<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>FIN0202 Create VAT Purchases Entries | ERP.net Domain Model </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="FIN0202 Create VAT Purchases Entries | ERP.net Domain Model ">
    <meta name="generator" content="docfx 2.56.9.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="fin0202-create-vat-purchases-entries">FIN0202 Create VAT Purchases Entries</h1>

<h2 id="basic-information">Basic Information</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Module</th>
<th>Logistics.Procurement</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Code</td>
<td>FIN0202</td>
</tr>
<tr>
<td style="text-align: left;">Parent Document</td>
<td>PurchaseInvoice</td>
</tr>
<tr>
<td style="text-align: left;">Sub-document</td>
<td>VAT.Entries</td>
</tr>
<tr>
<td style="text-align: left;">Full Name</td>
<td>Create VAT purchases ledger entries</td>
</tr>
<tr>
<td style="text-align: left;">Status</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/documents/generation-procedures.html">ACTIVE</a></td>
</tr>
<tr>
<td style="text-align: left;">Deterministic</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/documents/document-generation-and-transitional-documents.html">YES</a></td>
</tr>
<tr>
<td style="text-align: left;">Supports Transitional Documents</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/documents/document-generation-and-transitional-documents.html">NO</a></td>
</tr>
<tr>
<td style="text-align: left;">Replaces</td>
<td>GenerateEntry; GenerateEntrySkipNote</td>
</tr>
<tr>
<td style="text-align: left;">Orphan Rows</td>
<td>Forbid</td>
</tr>
<tr>
<td style="text-align: left;">Introduced In Version</td>
<td>2022</td>
</tr>
<tr>
<td style="text-align: left;">Date of Suspension</td>
<td>-</td>
</tr>
</tbody>
</table>
<h2 id="business-logic">Business Logic</h2>
<p>The generation is used for creating records in VAT Entry for Purchases These records contain VAT Amount and VAT Base Amount from current Purchase Invoice, divided by Deals Types wich are in document. These records are used for creating data for VAT Declaration for this document for the reporting period.</p>
<p>The PurchaseInvoiceLine amounts are created for each DealType from distributed amount for current line for VATDocumentAmountType, grouped by LineDealType. It will be used these auxiliary variables:</p>
<blockquote>
<p>VATDocumentAmountType = Invoice.EnterpriseCompany.VATDocumentAmountType</p>
<p>VATDocumentAmountCurrency = IIF(Invoice.DocumentAmounts.InputAmountCurrency is not Null, Invoice.DocumentAmounts.InputAmountCurrency Where Invoice.DocumentAmounts.DocumentAmountType = VATDocumentAmountType, Invoice.DocumentCurrency)</p>
<p>DealTypeAmount = SUM (Invoice.DocumentDistributedAmount/Amount) WHERE DocumentLineId = InvoiceLine DocumentAmountType=VATDocumentAmountType Group By LineDealType</p>
<p>DealTypeBaseAmount = SUM (Invoice.DocumentDistributedAmount/BaseAmount) WHERE DocumentLineId = InvoiceLine DocumentAmountType=VATDocumentAmountType Group By LineDealType</p>
<p>VATDealType = InvoiceLine.LineDealType Group By LineDealType - it is same which is used for grouping in DealTypeAmount and DealTypeBaseAmount.</p>
</blockquote>
<p>The Document table attributes are filled in as described in <a href="../reference/standard-document-attributes.html">Standard Document Attributes</a>.</p>
<h2 id="fulfillments">Fulfillments</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Name</th>
<th>InvoiceLineToVATEnrty</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Parent Entity</td>
<td>InvoiceLine</td>
</tr>
<tr>
<td style="text-align: left;">Child Entity</td>
<td>VAT.Entry</td>
</tr>
<tr>
<td style="text-align: left;">Parent / Child Relations</td>
<td>Entry.ParentDocument = Invoice; Entry.DealType = DealType; Entry.RegistrationVATNumber = Invoice.Customer.RegistrationVATNumber, Entry.RegistrationNumber = Invoice.Customer.RegistrationNumber, VATEntry.ApplyDate = Invoice.ApplyDate</td>
</tr>
</tbody>
</table>
<h2 id="metrics"><a href="../reference/metrics.html">Metrics</a></h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Fulfillment Name</th>
<th style="text-align: center;">Metric Name</th>
<th style="text-align: center;">Measurement Unit</th>
<th style="text-align: left;">Parent Value</th>
<th style="text-align: left;">Child Value</th>
<th style="text-align: left;">New Record</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">InvoiceLineToVATEnrty</td>
<td style="text-align: center;">AmountBase</td>
<td style="text-align: center;">VATDocumentAmountCurrency</td>
<td style="text-align: left;">DealTypeAmount</td>
<td style="text-align: left;">Entry.AmountBase</td>
<td style="text-align: left;">YES</td>
</tr>
<tr>
<td style="text-align: left;">InvoiceLineToVATEnrty</td>
<td style="text-align: center;">VATAmountBase</td>
<td style="text-align: center;">VATDocumentAmountCurrency</td>
<td style="text-align: left;">DealTypeBaseAmount</td>
<td style="text-align: left;">Entry.VATAmountBase</td>
<td style="text-align: left;">YES</td>
</tr>
</tbody>
</table>
<p>Entry.EntryType = Sales</p>
<p>Entry.DealType = VATDealType</p>
<p>Entry.Party = Invoice.Customer.Party</p>
<p>If Invoice.Customer.Party.PartyType = Company then Entry.RegistrationVATNumber = Invoice.Customer.RegistrationVATNumber</p>
<p>if (Invoice.Customer.RegistrationNumber.HasValue and Invoice.Customer.Party.PartyType = Company) then
Entry.RegistrationNumber = Invoice.Customer.RegistrationNumber</p>
<p>if Invoice.Customer.Party.PartyType = Person   then Entry.RegistrationNumber   = Invoice.Customer.Party.Person.NationalNumber</p>
<p>Entry.ReferencedDocumentType = Invoice.DocumentType</p>
<p>Entry.ReferencedDocumentNo = Invoice.DocumentNo</p>
<p>Entry.AmountBase = Remaining(AmountBase)</p>
<p>Entry.VATAmountBase = Remaining(VATAmountBase)</p>
<p>Entry.ApplyDate = Invoice.ApplyDate</p>
<p>Entry.CashReportingMode = Invoice.VATCashReportingMode</p>
<p>if Invoice.VATNotes.HasValue then
VATEntry.Notes = Invoice.VATNotes
Else If  Entry.EnterpriseCompany is Bulgaria then VATEntry.Notes = &quot;Продажба на стоки/услуги.&quot;</p>
<p>RegistrationVATNumber, RegistrationNumber  And VATNotes can be null if there is no value for them.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/ErpNetDocs/model/blob/master/generations/FIN0202.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
