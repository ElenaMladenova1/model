---
erp.type: front-end-business-rule
erp.entity: General.Contacts.PartyContactMechanisms
---

# R32769-5 PartyContactMechanisms - Set Line Ord
+-----------------+-------------------------------------------------------------------------------------+
| **Code**        | R32769-5                                                                            |
+-----------------+-------------------------------------------------------------------------------------+
| **Entity**      | @General.Contacts.PartyContactMechanisms                                            |
+-----------------+-------------------------------------------------------------------------------------+
| **Name**        | SetLineOrd                                                                          |
+-----------------+-------------------------------------------------------------------------------------+
| **Attribute**   | LineOrd                                                                             |
+-----------------+-------------------------------------------------------------------------------------+
| **Layer**       | Front-End                                                                           |
+-----------------+-------------------------------------------------------------------------------------+
| **Events**      | AttributeChanged(Party, ContactMechanism.ContactMechanismType)                      |
+-----------------+-------------------------------------------------------------------------------------+
| **Priority**    | Normal                                                                              |
+-----------------+-------------------------------------------------------------------------------------+
| **Modify**      | YES                                                                                 |
+-----------------+-------------------------------------------------------------------------------------+
| **Action**      | Set a value in LineOrd field after applying the following algorithm:                |                 
|                 | <br><br/>                                                                           | 
|                 | (1) Select all the records in PartyContactMechanism table where: <br/>              | 
|                 | Party = current PartyContactMechanism.Party AND <br/>                               | 
|                 | ContactMechanism.ContactMechanismType = current PartyContactMechanism.ContactMechanism.ContactMechanismType <br/>
|                 | <br>                                                                                |
|                 | (2) Sort them in descending order by LinOrd <br/>                                   |
|                 | <br>                                                                                |
|                 | (3) From the first record - get the value from LineOrd field <br/>                  |
|                 | <br>                                                                                |
|                 | (4) Increment this value by 1.<br/>                                                 |
|                 | <br>                                                                                |
|                 | If there are no records found, then set 1 in LineOrd field.                         | 
+-----------------+-------------------------------------------------------------------------------------+
| **Description** | The rule sets a value in LineOrd field.<br/>                                        | 
|                 | This value is determined by taking the last (highest numbered)                      | 
|                 | PartyContactMechanism record of the same ContactMechanismType                       | 
|                 | within the current Party, and by adding one to the LineOrd of the last record.<br/> | 
|                 | If no such record, then LineOrd is set to 1.                                        | 
+-----------------+-------------------------------------------------------------------------------------+
| **Message**     |  \-                                                                                 | 
+-----------------+-------------------------------------------------------------------------------------+
| **Version**     | Introduced: 2022                                                                    |
+-----------------+-------------------------------------------------------------------------------------+
| **Revocable**   | NO                                                                                  |
+-----------------+-------------------------------------------------------------------------------------+

*\* For more information about the Business Rules Documentation Template and a short explanation of each column, see
topic [System Business Rules](../templates/template-description-system-business-rules.md).*
