---
erp.entity: Logistics.Inventory.StoreOrders
erp.type: generation
---

# LOG0207 Create Store transaction (for the completed warehouse operations)

## Basic Information

| Module                          | Logistics.Inventory                                               |
| :------------------------------ | ----------------------------------------------------------------- |
| Code                            | LOG0207                                                           |
| Parent Document                 | StoreOrder                                                        |
| Sub-document                    | StoreTransaction                                                  |
| Full Name                       | Create Store transaction (for the completed warehouse operations) |
| Status                          | [ACTIVE](xref:generation-procedures) |
| Deterministic                   | [YES](xref:document-generation-and-transitional-documents) |
| Supports Transitional Documents | [NO](xref:document-generation-and-transitional-documents) |
| Replaces                        | -                                                                 |
| Orphan Rows                     | Ignore                                                            |
| Version                         | Introduced: 2022                                                  |
| Date of Suspension              | -                                                                 |

## Business Logic

The generation is used to create Store transactions from Store orders, when the WMS module is used for their execution.
 When the Store order is executed by the WMS module, the generation of the Store transactions is based on the data from this execution. This includes the data about the executed quantity, lot, serial number and i.e. For a complete document flow diagram of the WMS execution, you can see topic


The Store Transaction’s header is created based on the Store Order’s header as follows:

```
Transaction.ParentStoreOrder = StoreOrder

Transaction.Store = StoreOrder.Store

Transaction.MovementType = StoreOrder.MovementType

Transaction.DocumentCurrency = StoreOrder.DocumentCurrency
```

> [!Note] 
> The attributes which are not specified here are filled in as described in [Standard Document Attributes](../reference/standard-document-attributes.md)

> [!Note] 
> The new store transaction is saved then and only when there is at least one line in it.

## Fulfillments

| Fulfilment Name                              | StoreOrderLineToStoreTransactionLineByFulfillmentTable        |
| :------------------------------------------- | ------------------------------------------------------------ |
| Fulfilment Tracking Type                     | Fulfilment Table                                             |
| Parent Entity                                | StoreOrderLine                                     |
| Child Entity                                 | StoreTransactionLine                                          |
| Parent Entity/ Fulfilment Table Relationship | StoreOrderLineId = DocumentFulfillment.DocumentLineId |


| Fulfilment Name                              | StoreOrderLineToStoreTransactionLineByParentDocument         |
| :------------------------------------------- | ------------------------------------------------------------ |
| Fulfilment Tracking Type                     | Fulfilment Table                                             |
| Parent Entity                                | StoreOrderLine                                     |
| Child Entity                                 | StoreTransactionLine                                          |
| Parent Entity/ Fulfilment Table Relationship | StoreTransactionLine.ParentDocument = StoreOrder;StoreTransactionLine.ParentLineNo = StoreOrderLine.LineNo |

## [Metrics](../reference/metrics.md)

| Fulfilment Name                              |  Metric Name  |                   Measurement Unit                   | Parent Value                              | Fulfilment Table Value           | New Record |
| :------------------------------------------- | :-----------: | :--------------------------------------------------: | :---------------------------------------- | :------------------------------- | :--------- |
| StoreOrderLineToStoreTransactionLineByFulfillmentTable | MQuantityBase | StoreOrderLine.Product.BaseMeasurementUnit | DocumentFulfillments(where 'FulfillmentType = Completed' AND 'DestinationEntityName = Wms_Warehouse_Requisition_Lines').QuantityBase | DocumentFulfillments(where 'FulfillmentType = Completed' AND 'DestinationEntityName = Inv_Transaction_Lines').QuantityBase | NO |
| StoreOrderLineToStoreTransactionLineByFulfillmentTable | MStandardQuantity | StoreOrderLine.Product.BaseMeasurementUnit |  DocumentFulfillments(where 'FulfillmentType = Completed' AND 'DestinationEntityName = Wms_Warehouse_Requisition_Lines').StandardQuantity | DocumentFulfillments(where 'FulfillmentType = Completed' AND 'DestinationEntityName = 'Inv_Transaction_Lines').StandardQuantity | YES |
| StoreOrderLineToStoreTransactionLineByParentDocument |       MLineCost       |        StoreOrder.DocumentCurrency         | StoreOrderLine.LineCost             | StoreTransactionLine.LineCost             | if (StoreOrder.MovementType== Receipt) {New Record = YES},else {New Record = NO} |

<br/><br/>
The lines of the new document are created based on the data of the Completed records in the Document Fulfillments table. The table contains information aboout the execution of the operations in the WMS module and the for the fulfilled part of quantities by the Store Transaction which have already been created (if any).

A separate Store Transaction Lines is created for each record of Document Fulfillments which were created from the WMS module. This is necessary because it is possible that the different Document Fulfillments contain a breakdown of the executed lots, serial numbers, etc which have to be recorded into the Store Transaction as well.

> [!Note]
> Note that for the calculation are taken into account only the recods whoose Fulfillment Type is Completed AND DestinationEntityName is 'Wms_Warehouse_Requisition_Lines' OR 'Inv_Transaction_Lines'.

<br/>

**The new StoreTransactionLine is created as follows:**

```
StoreTransactionLine.LineNo = autonumber

StoreTransactionLine.ParentStoreOrderLine = StoreOrderLine

StoreTransactionLine.StoreBin = StoreOrderLine.StoreBin

StoreTransactionLine.OriginalProduct = StoreOrderLine.Product

StoreTransactionLine.Product = DocumentFulfillment.Product

StoreTransactionLine.ProductVariant = DocumentFulfillment.ProductVariant

StoreTransactionLine.Lot = DocumentFulfillment.Lot

StoreTransactionLine.SerialNumber = DocumentFulfillment.SerialNumber

StoreTransactionLine.QuantityUnit = StoreOrderLine.QuantityUnit  

StoreTransactionLine.Quantity = CONVERT(REMAINING(MStandardQuantity), StoreTransactionLine.QuantityUnit)

StoreTransactionLine.QuantityBase = REMAINING(MQuantityBase)

StoreTransactionLine.StandardQuantityBase = REMAINING(MStandardQuantity)

StoreTransactionLine.UnitCost = StoreOrderLine.UnitCost

StoreTransactionLine.LineCost = if (StoreOrder.MovementType == Receipt) {StoreTransactionLine.LineCost = StoreOrderLine.REMAINING(MLineCost)}, else {StoreTransactionLine.LineCost = 0.00}

StoreTransactionLine.GuaranteePeriodDays = StoreOrderLine.GuaranteePeriodDays

StoreTransactionLine.ParentLineId = StoreOrderLine.ParentLineId

StoreTransactionLine.ParentLineNo = StoreOrderLine.LineNo

StoreTransactionLine.TransactionTimestamp = null

StoreTransactionLine.Notes = StoreOrderLine.Notes
```

**The new Document Fulfillment is created as follows:**

```
DocumentFulfillment.Document = StoreOrder

DocumentFulfillment.DocumentLineId = StoreOrderLineId

DocumentFulfillment.LineNo = StoreOrderLine.LineNo

DocumentFulfillment.FulfillmentType = Planned

DocumentFulfillment.IsFinal = If (StoreTransaction.DocumentType.GenerateSingleDocument = true)

                          , then DocumentFulfillment.IsFinal = true

                          , else DocumentFulfillment.IsFinal = false

DocumentFulfillment.LineType = Line

DocumentFulfillment.QuantityBase = StoreTransactionLine.QuantityBase

DocumentFulfillment.StandardQuantity = StoreTransactionLine.StandardQuantity

DocumentFulfillment.Product = StoreTransactionLine.Product

DocumentFulfillment.Lot = StoreTransactionLine.Lot

DocumentFulfillment.SerialNumber = StoreTransactionLine.SerialNumber

DocumentFulfillment.ProductVariant = StoreTransactionLine.ProductVariant

DocumentFulfillment.DestinationEntityName = Inv_Transaction_Lines

```
